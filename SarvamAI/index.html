<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sarvam AI Full Model Stack Client</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Theme colors inspired by modern tech aesthetics */
            --bg-color: #0d121c; /* Deep Navy/Indigo */
            --card-color: #1a2233;
            --text-color: #e4e4f7;
            --accent-color: #ff6e40; /* Vibrant Orange/Coral */
            --success-color: #4CAF50;
            --error-color: #F44336;
            --warning-color: #FFC107;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s;
        }
        .card {
            background-color: var(--card-color);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .btn-primary {
            background-color: var(--accent-color);
            color: var(--card-color);
            font-weight: 700;
            transition: background-color 0.2s, transform 0.1s;
        }
        .btn-primary:hover:not(:disabled) {
            background-color: #ff8860;
            transform: translateY(-1px);
        }
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        textarea, input[type="text"], select, input[type="file"] {
            background-color: #121827;
            border: 1px solid #364055;
            color: var(--text-color);
            resize: none;
        }
        input[type="file"] {
            padding: 0.5rem;
        }
        .response-box {
            white-space: pre-wrap;
            line-height: 1.6;
            min-height: 100px;
            padding: 1rem;
            border-left: 4px solid var(--accent-color);
            background-color: #161e30;
            border-radius: 0 8px 8px 0;
            opacity: 0.9;
            transition: all 0.3s;
            overflow-x: auto;
        }
        /* Custom spinner for loading state */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: none; /* Controlled by JS */
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .grid-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }
        @media (min-width: 1024px) {
            .grid-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8 flex items-start justify-center min-h-screen">

    <div id="app" class="w-full max-w-6xl">

        <h1 class="text-4xl font-bold mb-8 text-center text-white">Sarvam AI Full Model Stack Client</h1>

        <!-- API Key Configuration Card -->
        <div class="card p-6 rounded-xl mb-8">
            <h2 class="text-xl font-semibold mb-4 text-white flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2 text-yellow-400"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                Sarvam AI API Key
            </h2>
            <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
                <input
                    type="text"
                    id="apiKeyInput"
                    placeholder="Enter your Sarvam AI Key (e.g., sk_...)"
                    class="flex-grow p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-color"
                >
                <button
                    id="saveKeyBtn"
                    class="btn-primary p-3 rounded-lg whitespace-nowrap"
                    onclick="saveApiKey()"
                >
                    Save Key
                </button>
            </div>
            <p id="keyStatus" class="mt-2 text-sm"></p>
        </div>

        <div class="grid-container">

            <!-- 1. Sarvam-M Chat Interface Card -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-xl font-semibold mb-4 text-white flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2 text-blue-400"><path d="M12 2a10 10 0 0 0-9.22 13.9A1 1 0 0 1 3.2 17H.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5H5v-4H3.2a3 3 0 0 0-.8-3.72A8 8 0 1 1 12 2z"></path></svg>
                    1. LLM Chat (sarvam-m)
                </h2>
                <textarea
                    id="chatPromptInput"
                    rows="4"
                    placeholder="Ask the LLM anything in English or an Indic language..."
                    class="w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-color mb-4"
                    oninput="checkInputs('chat')"
                ></textarea>
                <div class="flex items-center justify-between">
                    <button
                        id="chatSubmitBtn"
                        class="btn-primary p-3 rounded-lg flex items-center space-x-2"
                        onclick="generateChatContent()"
                        disabled
                    >
                        <span>Send Request</span>
                    </button>
                    <div id="chatLoadingIndicator" class="spinner"></div>
                </div>
                <div class="mt-4">
                    <h3 class="text-base font-semibold mb-2 text-white opacity-80">Response:</h3>
                    <div id="chatResponseText" class="response-box text-sm">The Sarvam-M response will appear here.</div>
                </div>
            </div>

            <!-- 2. Sarvam Translate Interface Card -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-xl font-semibold mb-4 text-white flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2 text-red-400"><path d="M5 8h14"></path><path d="M5 12h14"></path><path d="M5 16h14"></path><path d="M8 7l-3-3-3 3"></path><path d="M16 17l3 3 3-3"></path></svg>
                    2. Text Translation (mayura:v1)
                </h2>
                <div class="mb-4 flex items-center justify-between space-x-2">
                    <label class="text-sm opacity-70">Source:</label>
                    <select id="sourceLang" class="p-2 rounded-lg text-sm w-1/3">
                        <option value="en-IN">English (en-IN)</option>
                        <option value="hi-IN">Hindi (hi-IN)</option>
                    </select>
                    <label class="text-sm opacity-70">Target:</label>
                    <select id="targetLang" class="p-2 rounded-lg text-sm w-1/3">
                        <option value="hi-IN">Hindi (hi-IN)</option>
                        <option value="en-IN">English (en-IN)</option>
                    </select>
                </div>
                <textarea
                    id="translateInput"
                    rows="4"
                    placeholder="Enter text to translate..."
                    class="w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-color mb-4"
                    oninput="checkInputs('translate')"
                ></textarea>
                <div class="flex items-center justify-between">
                    <button
                        id="translateSubmitBtn"
                        class="btn-primary p-3 rounded-lg flex items-center space-x-2"
                        onclick="translateText()"
                        disabled
                    >
                        <span>Translate Text</span>
                    </button>
                    <div id="translateLoadingIndicator" class="spinner"></div>
                </div>
                <div class="mt-4">
                    <h3 class="text-base font-semibold mb-2 text-white opacity-80">Translation:</h3>
                    <div id="translateResponseText" class="response-box text-sm">The translation will appear here.</div>
                </div>
            </div>

            <!-- 3. Saarika ASR Interface Card -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-xl font-semibold mb-4 text-white flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2 text-green-400"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                    3. Speech-to-Text (saarika:v1)
                </h2>
                <div class="mb-4">
                    <label class="block text-sm opacity-70 mb-2">Upload Audio (.wav, .mp3, .flac):</label>
                    <input
                        type="file"
                        id="asrFileInput"
                        accept="audio/*"
                        class="w-full p-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-color"
                        onchange="checkInputs('asr')"
                    >
                </div>
                <div class="flex items-center justify-between">
                    <button
                        id="asrSubmitBtn"
                        class="btn-primary p-3 rounded-lg flex items-center space-x-2"
                        onclick="asrAudioToText()"
                        disabled
                    >
                        <span>Transcribe Audio</span>
                    </button>
                    <div id="asrLoadingIndicator" class="spinner"></div>
                </div>
                <div class="mt-4">
                    <h3 class="text-base font-semibold mb-2 text-white opacity-80">Transcription:</h3>
                    <div id="asrResponseText" class="response-box text-sm">Upload an audio file to see the transcribed text.</div>
                </div>
            </div>

            <!-- 4. Bulbul TTS Interface Card -->
            <div class="card p-6 rounded-xl">
                <h2 class="text-xl font-semibold mb-4 text-white flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2 text-orange-400"><path d="M11 5v2.83a4 4 0 0 1 1.41 1.41L15 12l-2.59 2.76a4 4 0 0 1-1.41 1.41V19"></path><path d="M22 12h-3"></path><path d="M5 12H2"></path><path d="M12 22a10 10 0 0 0 10-10"></path><path d="M2 12A10 10 0 0 1 12 2"></path></svg>
                    4. Text-to-Speech (bulbul:v1)
                </h2>
                <textarea
                    id="ttsTextInput"
                    rows="4"
                    placeholder="Enter text to convert to speech..."
                    class="w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-color mb-4"
                    oninput="checkInputs('tts')"
                ></textarea>
                <div class="mb-4 flex items-center space-x-4">
                     <label class="text-sm opacity-70">Language:</label>
                    <select id="ttsLang" class="p-2 rounded-lg text-sm">
                        <option value="hi">Hindi (hi)</option>
                        <option value="en">English (en)</option>
                        <option value="mr">Marathi (mr)</option>
                        <option value="bn">Bengali (bn)</option>
                    </select>
                </div>
                <div class="flex items-center justify-between">
                    <button
                        id="ttsSubmitBtn"
                        class="btn-primary p-3 rounded-lg flex items-center space-x-2"
                        onclick="ttsTextToAudio()"
                        disabled
                    >
                        <span>Generate Speech</span>
                    </button>
                    <div id="ttsLoadingIndicator" class="spinner"></div>
                </div>
                <div class="mt-4">
                    <h3 class="text-base font-semibold mb-2 text-white opacity-80">Playback:</h3>
                    <audio id="ttsAudioPlayer" controls class="w-full bg-card-color rounded-lg mt-2 p-2 hidden"></audio>
                    <div id="ttsResponseText" class="response-box text-sm">Enter text and generate audio to play it back.</div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- Configuration & Initialization ---
        // Endpoints
        const SARVAM_CHAT_URL = 'https://api.sarvam.ai/v1/chat/completions';
        const SARVAM_TRANSLATE_URL = 'https://api.sarvam.ai/v1/translate';
        const SARVAM_ASR_URL = 'https://api.sarvam.ai/v1/asr';
        const SARVAM_TTS_URL = 'https://api.sarvam.ai/v1/tts';

        // Models
        const SARVAM_CHAT_MODEL = 'sarvam-m';
        const SARVAM_TRANSLATE_MODEL = 'mayura:v1';
        const SARVAM_ASR_MODEL = 'saarika:v1';
        const SARVAM_TTS_MODEL = 'bulbul:v1';

        const MAX_RETRIES = 3;
        const INITIAL_BACKOFF = 1000;

        const apiKeyInput = document.getElementById('apiKeyInput');
        const keyStatus = document.getElementById('keyStatus');

        // Chat elements
        const chatPromptInput = document.getElementById('chatPromptInput');
        const chatSubmitBtn = document.getElementById('chatSubmitBtn');
        const chatLoadingIndicator = document.getElementById('chatLoadingIndicator');
        const chatResponseText = document.getElementById('chatResponseText');

        // Translate elements
        const sourceLang = document.getElementById('sourceLang');
        const targetLang = document.getElementById('targetLang');
        const translateInput = document.getElementById('translateInput');
        const translateSubmitBtn = document.getElementById('translateSubmitBtn');
        const translateLoadingIndicator = document.getElementById('translateLoadingIndicator');
        const translateResponseText = document.getElementById('translateResponseText');

        // ASR elements
        const asrFileInput = document.getElementById('asrFileInput');
        const asrSubmitBtn = document.getElementById('asrSubmitBtn');
        const asrLoadingIndicator = document.getElementById('asrLoadingIndicator');
        const asrResponseText = document.getElementById('asrResponseText');

        // TTS elements
        const ttsTextInput = document.getElementById('ttsTextInput');
        const ttsLang = document.getElementById('ttsLang');
        const ttsSubmitBtn = document.getElementById('ttsSubmitBtn');
        const ttsLoadingIndicator = document.getElementById('ttsLoadingIndicator');
        const ttsAudioPlayer = document.getElementById('ttsAudioPlayer');
        const ttsResponseText = document.getElementById('ttsResponseText');


        let currentApiKey = '';

        // --- API Key Management ---

        function loadApiKey() {
            const storedKey = localStorage.getItem('sarvamApiKey');
            if (storedKey) {
                currentApiKey = storedKey;
                apiKeyInput.value = storedKey;
                keyStatus.textContent = 'Sarvam AI Key loaded successfully.';
                keyStatus.classList.remove('text-error-color', 'text-yellow-400');
                keyStatus.classList.add('text-success-color');
            } else {
                keyStatus.textContent = 'Please enter your Sarvam AI API Key to enable features.';
                keyStatus.classList.remove('text-success-color', 'text-error-color');
                keyStatus.classList.add('text-yellow-400');
            }
            checkInputs('all');
        }

        function saveApiKey() {
            const newKey = apiKeyInput.value.trim();
            if (newKey) {
                localStorage.setItem('sarvamApiKey', newKey);
                currentApiKey = newKey;
                keyStatus.textContent = 'Key saved! All features are now active.';
                keyStatus.classList.remove('text-error-color', 'text-yellow-400');
                keyStatus.classList.add('text-success-color');
            } else {
                localStorage.removeItem('sarvamApiKey');
                currentApiKey = '';
                keyStatus.textContent = 'Key cannot be empty. Please enter your key.';
                keyStatus.classList.remove('text-success-color', 'text-yellow-400');
                keyStatus.classList.add('text-error-color');
            }
            checkInputs('all');
        }

        /**
         * Checks if inputs are ready to enable buttons.
         */
        function checkInputs(type) {
            const isKeyReady = !!currentApiKey;

            if (type === 'chat' || type === 'all') {
                const isChatPromptReady = chatPromptInput.value.trim().length > 0;
                chatSubmitBtn.disabled = !(isKeyReady && isChatPromptReady);
            }

            if (type === 'translate' || type === 'all') {
                const isTranslateInputReady = translateInput.value.trim().length > 0;
                translateSubmitBtn.disabled = !(isKeyReady && isTranslateInputReady);
            }

            if (type === 'asr' || type === 'all') {
                const isAsrFileReady = asrFileInput.files && asrFileInput.files.length > 0;
                asrSubmitBtn.disabled = !(isKeyReady && isAsrFileReady);
            }

            if (type === 'tts' || type === 'all') {
                const isTtsTextReady = ttsTextInput.value.trim().length > 0;
                ttsSubmitBtn.disabled = !(isKeyReady && isTtsTextReady);
            }
        }

        /**
         * Generic fetch function with exponential backoff for retries.
         * Handles both JSON and FormData payloads.
         */
        async function apiFetch(url, payload, loadingElement, responseElement, isFormData = false, attempt = 0) {
            loadingElement.style.display = 'block';
            responseElement.textContent = 'Processing request...';
            responseElement.style.borderLeftColor = 'var(--accent-color)';
            
            const apiKey = currentApiKey;
            let finalResult = null;
            let errorMessage = '';

            try {
                const headers = {
                    'Authorization': `Bearer ${apiKey}`,
                };
                
                // Do not set Content-Type header manually for FormData, the browser handles it.
                if (!isFormData) {
                    headers['Content-Type'] = 'application/json';
                }

                const response = await fetch(url, {
                    method: 'POST',
                    headers: headers,
                    body: isFormData ? payload : JSON.stringify(payload)
                });

                if (response.status === 429 && attempt < MAX_RETRIES) {
                    const delay = INITIAL_BACKOFF * Math.pow(2, attempt) + Math.random() * 500;
                    await new Promise(resolve => setTimeout(resolve, delay));
                    return apiFetch(url, payload, loadingElement, responseElement, isFormData, attempt + 1);
                }

                if (!response.ok) {
                    const errorJson = await response.json().catch(() => ({}));
                    errorMessage = `API Request failed: ${response.status}.`;

                    if (response.status === 401 || response.status === 403) {
                        errorMessage = "Authentication Error: Invalid Sarvam AI API Key. Please check the key.";
                    } else if (errorJson.error && errorJson.error.message) {
                        errorMessage += ` Details: ${errorJson.error.message}`;
                    } else if (errorJson.message) {
                        errorMessage += ` Details: ${errorJson.message}`;
                    } else {
                        errorMessage += ` (Check console for raw error)`;
                    }
                    throw new Error(errorMessage);
                }

                const result = await response.json();
                finalResult = result;

            } catch (error) {
                errorMessage = error.message;
            } finally {
                loadingElement.style.display = 'none';
            }

            if (errorMessage) {
                responseElement.textContent = `Error: ${errorMessage}`;
                responseElement.style.borderLeftColor = 'var(--error-color)';
                return null;
            }
            return finalResult;
        }

        // --- 1. Chat Completion (Sarvam-M) ---
        async function generateChatContent() {
            chatSubmitBtn.disabled = true;
            const userQuery = chatPromptInput.value.trim();

            const payload = {
                model: SARVAM_CHAT_MODEL,
                messages: [
                    { "role": "system", "content": "You are Sarvam AI, an assistant specialized in Indian languages and general knowledge. Respond concisely and accurately." },
                    { "role": "user", "content": userQuery }
                ],
                max_tokens: 1024,
                temperature: 0.7
            };

            const result = await apiFetch(SARVAM_CHAT_URL, payload, chatLoadingIndicator, chatResponseText);

            if (result) {
                const text = result.choices?.[0]?.message?.content || "No response text received.";

                // Simple formatting for display
                chatResponseText.innerHTML = text.replace(/(\*\*|__)(.*?)\1/g, '<strong>$2</strong>')
                                                 .replace(/(\*|_)(.*?)\1/g, '<em>$2</em>')
                                                 .replace(/\n/g, '<br>');
            }

            checkInputs('chat');
        }

        // --- 2. Text Translation (Mayura) ---
        async function translateText() {
            translateSubmitBtn.disabled = true;
            const input = translateInput.value.trim();
            const source_language_code = sourceLang.value;
            const target_language_code = targetLang.value;

            if (source_language_code === target_language_code) {
                 translateResponseText.textContent = "Error: Source and target languages cannot be the same.";
                 translateResponseText.style.borderLeftColor = 'var(--error-color)';
                 translateSubmitBtn.disabled = false;
                 return;
            }

            const payload = {
                input: input,
                source_language_code: source_language_code,
                target_language_code: target_language_code,
                model: SARVAM_TRANSLATE_MODEL,
                mode: "formal"
            };

            const result = await apiFetch(SARVAM_TRANSLATE_URL, payload, translateLoadingIndicator, translateResponseText);

            if (result && result.translated_text) {
                translateResponseText.textContent = result.translated_text;
            } else if (result && !result.translated_text) {
                translateResponseText.textContent = "Translation failed or returned an empty result.";
                translateResponseText.style.borderLeftColor = 'var(--warning-color)';
            }

            checkInputs('translate');
        }

        // --- 3. Speech-to-Text (Saarika) ---
        async function asrAudioToText() {
            asrSubmitBtn.disabled = true;
            const file = asrFileInput.files[0];

            if (!file) {
                asrResponseText.textContent = "Please select an audio file.";
                asrResponseText.style.borderLeftColor = 'var(--warning-color)';
                asrSubmitBtn.disabled = false;
                return;
            }

            const formData = new FormData();
            formData.append('file', file); // The file to upload
            
            // Add other parameters as a JSON string for the 'data' field
            const configData = {
                model_id: SARVAM_ASR_MODEL,
                // Add language code if necessary (e.g., "hi", "en"), though model is usually auto-detecting
            };
            formData.append('data', JSON.stringify(configData));


            const result = await apiFetch(SARVAM_ASR_URL, formData, asrLoadingIndicator, asrResponseText, true);

            if (result && result.transcription) {
                asrResponseText.textContent = result.transcription;
            } else if (result && !result.transcription) {
                asrResponseText.textContent = "Transcription failed or returned empty result.";
                asrResponseText.style.borderLeftColor = 'var(--warning-color)';
            }

            checkInputs('asr');
        }

        // --- 4. Text-to-Speech (Bulbul) ---
        async function ttsTextToAudio() {
            ttsSubmitBtn.disabled = true;
            ttsAudioPlayer.classList.add('hidden');
            const inputText = ttsTextInput.value.trim();
            const languageCode = ttsLang.value;
            
            const payload = {
                model_id: SARVAM_TTS_MODEL,
                text: inputText,
                // voice_id: "random", // Can specify voice if known
                language: languageCode
            };

            // Use apiFetch with the expectation that the API returns a JSON object 
            // containing the audio data (typically base64) or a direct audio stream.
            // Assuming it returns JSON with a 'audio_content' field (base64).
            const result = await apiFetch(SARVAM_TTS_URL, payload, ttsLoadingIndicator, ttsResponseText, false);

            if (result && result.audio_content) {
                // The API returns base64 encoded audio data (e.g., MP3 or WAV)
                const audioBase64 = result.audio_content;
                const audioFormat = result.audio_format || 'audio/wav'; // Guessing default format
                
                const audioUrl = `data:${audioFormat};base64,${audioBase64}`;
                ttsAudioPlayer.src = audioUrl;
                ttsAudioPlayer.classList.remove('hidden');
                ttsAudioPlayer.load();
                ttsResponseText.textContent = "Audio generated successfully. Click play to listen.";
            } else if (result) {
                ttsResponseText.textContent = "TTS failed or audio content was missing from the response.";
                ttsResponseText.style.borderLeftColor = 'var(--warning-color)';
            }

            checkInputs('tts');
        }

        // Initialize the app
        window.onload = () => {
            loadApiKey();

            // Setup listeners for language swap in translate card
            sourceLang.addEventListener('change', () => {
                if (sourceLang.value === targetLang.value) {
                    targetLang.value = sourceLang.value === 'en-IN' ? 'hi-IN' : 'en-IN';
                }
                checkInputs('translate');
            });
            targetLang.addEventListener('change', () => {
                if (sourceLang.value === targetLang.value) {
                    sourceLang.value = targetLang.value === 'en-IN' ? 'hi-IN' : 'en-IN';
                }
                checkInputs('translate');
            });

            // Add event listener for Enter key on the chat input
            chatPromptInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey && !chatSubmitBtn.disabled) {
                    e.preventDefault();
                    generateChatContent();
                }
            });
        };

    </script>
</body>
</html>

