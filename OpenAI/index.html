<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OpenAI Multi-Model Interface</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #10a37f 0%, #1a7f64 100%);
    min-height: 100vh;
    padding: 20px;
}
.container {
    max-width: 1400px;
    margin: 0 auto;
    background: white;
    border-radius: 20px;
    box-shadow: 0 25px 70px rgba(0,0,0,0.3);
    overflow: hidden;
}
.header {
    background: linear-gradient(135deg, #10a37f 0%, #1a7f64 100%);
    color: white;
    padding: 40px;
    text-align: center;
}
.header h1 { font-size:36px; margin-bottom:12px; font-weight:700; }
.header p { opacity:0.95; font-size:15px; }

/* --- Tab Navigation --- */
.tabs {
    display: flex;
    background: #f7f7f8;
    border-bottom: 2px solid #e5e5e5;
}
.tab {
    flex: 1;
    padding: 16px;
    text-align: center;
    font-weight: 600;
    cursor: pointer;
    background: #f7f7f8;
    border-right: 1px solid #e5e5e5;
    transition: background 0.3s;
}
.tab:last-child { border-right: none; }
.tab.active {
    background: white;
    color: #10a37f;
    border-bottom: 3px solid #10a37f;
}

/* --- Controls / Chat Section --- */
.section { display: none; }
.section.active { display: block; }

.controls {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
    gap:20px;
    padding:30px;
    background:#f7f7f8;
    border-bottom:2px solid #e5e5e5;
}
.control-group { display:flex; flex-direction:column; gap:10px; }
.control-group label { font-weight:600; color:#1a1a1a; font-size:13px; text-transform:uppercase; letter-spacing:0.5px; }
select, input {
    padding:14px;
    border:2px solid #e5e5e5;
    border-radius:10px;
    font-size:14px;
    transition: all 0.3s;
    background:white;
    font-family:inherit;
}
select:focus, input:focus { outline:none; border-color:#10a37f; box-shadow:0 0 0 3px rgba(16,163,127,0.1); }
.chat-container {
    height:550px;
    overflow-y:auto;
    padding:30px;
    background:#ffffff;
    scroll-behavior:smooth;
}
.message { margin-bottom:24px; display:flex; gap:14px; animation:slideIn 0.4s ease-out; }
@keyframes slideIn { from{opacity:0; transform:translateY(15px);} to{opacity:1; transform:translateY(0);} }
.message.user { flex-direction:row-reverse; }
.message-avatar {
    width:42px; height:42px; border-radius:50%; display:flex; align-items:center; justify-content:center;
    font-weight:bold; color:white; flex-shrink:0; font-size:18px;
}
.user .message-avatar { background: linear-gradient(135deg,#10a37f 0%,#1a7f64 100%); }
.assistant .message-avatar { background: linear-gradient(135deg,#ff6b6b 0%,#ee5a6f 100%); }
.message-content { max-width:75%; padding:16px 22px; border-radius:14px; line-height:1.6; font-size:15px; }
.user .message-content { background: linear-gradient(135deg,#10a37f 0%,#1a7f64 100%); color:white; border-bottom-right-radius:4px; }
.assistant .message-content { background:#f7f7f8; color:#1a1a1a; border:1px solid #e5e5e5; border-bottom-left-radius:4px; }
.model-badge { display:inline-block; padding:5px 12px; background: rgba(16,163,127,0.12); color:#10a37f; border-radius:16px; font-size:11px; font-weight:700; margin-bottom:10px; text-transform:uppercase; letter-spacing:0.5px; }
.input-container { padding:24px 30px; background:#f7f7f8; border-top:2px solid #e5e5e5; display:flex; gap:14px; align-items:flex-end; }
.input-container textarea { flex:1; padding:14px; border:2px solid #e5e5e5; border-radius:12px; font-size:15px; font-family:inherit; resize:none; min-height:60px; max-height:150px; }
.input-container textarea:focus { outline:none; border-color:#10a37f; box-shadow:0 0 0 3px rgba(16,163,127,0.1); }
.input-container button { padding:14px 32px; background:linear-gradient(135deg,#10a37f 0%,#1a7f64 100%); color:white; border:none; border-radius:12px; font-weight:700; cursor:pointer; transition: all 0.3s; font-size:15px; text-transform:uppercase; letter-spacing:0.5px; }
.input-container button:hover:not(:disabled) { transform:translateY(-2px); box-shadow:0 8px 20px rgba(16,163,127,0.3); }
.input-container button:disabled { opacity:0.5; cursor:not-allowed; }

.api-settings {
    padding:40px;
    background:#fff;
}
.api-settings label { display:block; margin-bottom:10px; font-weight:600; color:#333; }
.api-settings input {
    width:100%; padding:14px; font-size:15px;
    border:2px solid #e5e5e5; border-radius:10px;
}
.api-settings button {
    margin-top:20px; padding:14px 32px;
    background:linear-gradient(135deg,#10a37f 0%,#1a7f64 100%);
    color:white; border:none; border-radius:12px;
    font-weight:700; cursor:pointer;
    font-size:15px; text-transform:uppercase;
    letter-spacing:0.5px;
}
.api-settings button:hover { transform:translateY(-2px); box-shadow:0 8px 20px rgba(16,163,127,0.3); }

@media(max-width:768px){
    .controls{grid-template-columns:1fr;}
    .message-content{max-width:90%;}
    .header h1{font-size:28px;}
}
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>ü§ñ OpenAI Multi-Model Interface</h1>
        <p>Access GPT Mini models with deep modes & API key control</p>
    </div>

    <div class="tabs">
        <div class="tab active" id="chat-tab" onclick="switchTab('chat')">üí¨ Chat</div>
        <div class="tab" id="api-tab" onclick="switchTab('api')">üîë API Key</div>
    </div>

    <!-- Chat Section -->
    <div class="section active" id="chat-section">
        <div class="controls">
            <div class="control-group">
                <label for="model-select">üéØ Select Model</label>
                <select id="model-select">
                    <option value="gpt-4.1-mini" selected>GPT-4.1 Mini</option>
                    <option value="gpt-4o-mini">GPT-4o Mini</option>
                </select>
            </div>

            <div class="control-group">
                <label for="mode-select">‚öôÔ∏è Interaction Mode</label>
                <select id="mode-select">
                    <option value="normal" selected>Normal Chat</option>
                    <option value="deepthink">Deep Think</option>
                    <option value="deep-research">Deep Research</option>
                </select>
                <div class="mode-description" id="mode-description">Standard conversational mode with real-time responses</div>
            </div>
        </div>

        <div class="chat-container" id="chat-container">
            <div class="message assistant">
                <div class="message-avatar">AI</div>
                <div class="message-content">
                    <div class="model-badge">GPT-4.1 Mini - Normal Mode</div>
                    Welcome! Enter your API key under the API tab before chatting.
                </div>
            </div>
        </div>

        <div class="input-container">
            <textarea id="user-input" placeholder="Type your message here..."></textarea>
            <button id="send-btn" onclick="sendMessage()">Send</button>
        </div>
    </div>

    <!-- API Key Section -->
    <div class="section" id="api-section">
        <div class="api-settings">
            <label for="api-key-input">Enter your OpenAI API key:</label>
            <input type="password" id="api-key-input" placeholder="sk-..." />
            <button onclick="saveApiKey()">Save API Key</button>
            <p id="api-status" style="margin-top:15px; color:#10a37f; font-weight:600;"></p>
        </div>
    </div>
</div>

<script>
const BACKEND_URL = '/api/ask'; // placeholder for backend endpoint
let conversationHistory = [];

function switchTab(tab){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.getElementById(`${tab}-tab`).classList.add('active');
    document.getElementById(`${tab}-section`).classList.add('active');
}

// Save API key
function saveApiKey(){
    const key = document.getElementById('api-key-input').value.trim();
    if(!key){ alert('Please enter a valid API key'); return; }
    localStorage.setItem('openai_api_key', key);
    document.getElementById('api-status').textContent = '‚úÖ API Key saved securely (stored locally).';
    document.getElementById('api-key-input').value = '';
}

// Load saved API key (optional)
function getApiKey(){
    return localStorage.getItem('openai_api_key');
}

const modeDescriptions = {
    normal: 'Standard conversational mode with real-time responses',
    deepthink: 'Extended reasoning with step-by-step explanation',
    'deep-research': 'In-depth multi-perspective research and analysis'
};

document.getElementById('mode-select').addEventListener('change', function() {
    document.getElementById('mode-description').textContent = modeDescriptions[this.value];
});

document.getElementById('user-input').addEventListener('keydown', function(e){
    if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); sendMessage(); }
});

function addMessage(role, content, model, mode){
    const chatContainer = document.getElementById('chat-container');
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${role}`;
    const avatar = document.createElement('div');
    avatar.className = 'message-avatar';
    avatar.textContent = role==='user'?'U':'AI';
    const messageContent = document.createElement('div');
    messageContent.className='message-content';
    if(role==='assistant'){
        const badge = document.createElement('div');
        badge.className='model-badge';
        badge.textContent = `${model} - ${mode}`;
        messageContent.appendChild(badge);
    }
    const text = document.createElement('div');
    text.textContent = content;
    messageContent.appendChild(text);
    messageDiv.appendChild(avatar);
    messageDiv.appendChild(messageContent);
    chatContainer.appendChild(messageDiv);
    chatContainer.scrollTop=chatContainer.scrollHeight;
}

async function sendMessage(){
    const input = document.getElementById('user-input');
    const userText = input.value.trim();
    if(!userText) return;
    input.value = '';
    const model = document.getElementById('model-select').value;
    const mode = document.getElementById('mode-select').value;
    const apiKey = getApiKey();
    if(!apiKey){
        alert('Please set your API key in the API tab first!');
        return;
    }
    addMessage('user', userText, model, mode);

    let messages = [...conversationHistory, { role: 'user', content: userText }];
    if(mode==='deepthink'){
        messages.unshift({ role:'system', content:'Provide step-by-step reasoning.' });
    } else if(mode==='deep-research'){
        messages.unshift({ role:'system', content:'Provide multi-perspective in-depth analysis.' });
    }

    try{
        const response = await fetch(BACKEND_URL, {
            method:'POST',
            headers:{
                'Content-Type':'application/json',
                'Authorization':`Bearer ${apiKey}`
            },
            body: JSON.stringify({ model, messages })
        });
        const data = await response.json();
        const reply = data.choices?.[0]?.message?.content || 'No response';
        conversationHistory.push({ role:'user', content:userText });
        conversationHistory.push({ role:'assistant', content:reply });
        addMessage('assistant', reply, model, mode);
    } catch(err){
        console.error(err);
        addMessage('assistant','Error: '+err.message, model, mode);
    }
}
</script>
</body>
</html>
