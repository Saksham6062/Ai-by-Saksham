<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gemini AI Hub - Smart Text, Code & Research</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --bg-gradient: linear-gradient(135deg, #f5f7fa, #c3f0ff);
  --card-bg: #ffffffcc;
  --btn-bg: linear-gradient(45deg, #ff6b6b, #feca57);
  --btn-hover: linear-gradient(45deg, #ff4757, #ff9f43);
  --text: #222;
  --text-secondary: #666;
  --tab-bg: #f3f3f3cc;
  --tab-active-standard: #ff6b6b;
  --tab-active-canva: #1dd1a1;
  --tab-active-deepthink: #54a0ff;
  --tab-active-deepresearch: #f368e0;
  --input-bg: #ffffffb0;
  --lang-btn-bg: #fceae7;
  --lang-btn-hover: #f8c291;
}

* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Poppins', sans-serif; }

body {
  background: var(--bg-gradient);
  color: var(--text);
  padding: 25px;
  min-height: 100vh;
}

.container {
  max-width: 1000px;
  margin: auto;
}

h1 {
  text-align: center;
  font-size: 2.8rem;
  margin-bottom: 25px;
  background: linear-gradient(45deg, #ff6b6b, #1dd1a1);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.input-card {
  background: var(--card-bg);
  padding: 25px;
  border-radius: 20px;
  margin-bottom: 25px;
  backdrop-filter: blur(10px);
  box-shadow: 0 10px 20px rgba(0,0,0,0.1);
  transition: all 0.3s;
}

.input-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 14px 30px rgba(0,0,0,0.15);
}

input, textarea, select {
  width: 100%;
  padding: 14px;
  margin: 10px 0;
  border-radius: 15px;
  border: none;
  background: var(--input-bg);
  font-size: 1rem;
}

button {
  padding: 12px 22px;
  border-radius: 50px;
  border: none;
  background: var(--btn-bg);
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  box-shadow: 0 8px 15px rgba(0,0,0,0.15);
}
button:hover:not(:disabled) {
  background: var(--btn-hover);
  transform: scale(1.05);
  box-shadow: 0 10px 20px rgba(0,0,0,0.25);
}
button:disabled { opacity: 0.6; cursor: not-allowed; }

.mode-tab {
  display: inline-block;
  padding: 10px 22px;
  margin: 6px 6px 10px 0;
  border-radius: 50px;
  cursor: pointer;
  background: var(--tab-bg);
  transition: all 0.3s ease;
  font-weight: 600;
  box-shadow: 0 5px 12px rgba(0,0,0,0.05);
}
.mode-tab.active.standard { background: var(--tab-active-standard); color: #fff; }
.mode-tab.active.canva { background: var(--tab-active-canva); color: #fff; }
.mode-tab.active.deepthink { background: var(--tab-active-deepthink); color: #fff; }
.mode-tab.active.deepresearch { background: var(--tab-active-deepresearch); color: #fff; }

#response {
  background: var(--card-bg);
  padding: 20px;
  border-radius: 20px;
  min-height: 150px;
  white-space: pre-wrap;
  overflow: auto;
  margin-top: 15px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}

#editor {
  width: 100%;
  height: 300px;
  background: rgba(255,255,255,0.5);
  color: #222;
  padding: 15px;
  border-radius: 20px;
  margin-top: 10px;
  overflow: auto;
  white-space: pre;
  font-family: monospace;
}

iframe {
  width: 100%;
  height: 400px;
  border: none;
  border-radius: 20px;
  margin-top: 15px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.1);
}

.lang-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 10px;
}

.lang-btn {
  padding: 10px 16px;
  border-radius: 40px;
  border: none;
  background: var(--lang-btn-bg);
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 6px;
  font-weight: 500;
}
.lang-btn.active-lang { background: var(--tab-active-canva); color: #fff; }
.lang-btn:hover:not(.active-lang) { background: var(--lang-btn-hover); }

.sources-list {
  margin-top: 15px;
  list-style: none;
  padding-left: 0;
}
.sources-list li {
  margin-bottom: 6px;
  color: var(--text-secondary);
}
.sources-list li a {
  color: var(--tab-active-deepresearch);
  text-decoration: none;
}

.loader {
  border: 4px solid #f3f3f3;
  border-radius: 50%;
  border-top: 4px solid var(--tab-active-deepthink);
  width: 30px;
  height: 30px;
  animation: spin 1s linear infinite;
  margin: auto;
}
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
</style>
</head>
<body>
<div class="container">
  <h1><i class="fas fa-robot"></i> Gemini AI Hub</h1>

  <div class="input-card">
    <label><i class="fas fa-key"></i> Google AI API Key:</label>
    <input type="password" id="apiKey" placeholder="Enter API Key">

    <label><i class="fas fa-layer-group"></i> Gemini Model:</label>
    <select id="geminiVersion">
      <option value="gemini-2.5-flash-preview-05-20">2.5 Flash (Default)</option>
      <option value="gemini-2.5-pro">2.5 Pro</option>
      <option value="gemini-2.5-flash">2.5 Flash</option>
      <option value="gemini-2.5-flash-lite">2.5 Flash-Lite</option>
      <option value="gemini-2.0-flash">2.0 Flash</option>
      <option value="gemini-2.0-flash-lite">2.0 Flash-Lite</option>
    </select>

    <div style="margin-top:10px;">
      <div class="mode-tab active standard" data-mode="standard"><i class="fas fa-circle"></i> Standard</div>
      <div class="mode-tab" data-mode="canva"><i class="fas fa-paint-brush"></i> Canva</div>
      <div class="mode-tab" data-mode="deepthink"><i class="fas fa-brain"></i> DeepThink</div>
      <div class="mode-tab" data-mode="deepresearch"><i class="fas fa-search"></i> DeepResearch</div>
    </div>

    <label><i class="fas fa-edit"></i> Prompt:</label>
    <textarea id="userPrompt" rows="4" placeholder="Type your prompt here..."></textarea>
    <button id="generateButton" onclick="generate()"><i class="fas fa-play"></i> Generate</button>
  </div>

  <div id="response">Your output will appear here.</div>

  <div id="canva-container" style="display:none;">
    <div class="lang-buttons">
      <button class="lang-btn active-lang" data-lang="html"><i class="fas fa-code"></i> HTML</button>
      <button class="lang-btn" data-lang="css"><i class="fas fa-paint-brush"></i> CSS</button>
      <button class="lang-btn" data-lang="js"><i class="fas fa-terminal"></i> JS</button>
      <button class="lang-btn" data-lang="python"><i class="fab fa-python"></i> Python</button>
      <button class="lang-btn" data-lang="java"><i class="fab fa-java"></i> Java</button>
      <button class="lang-btn" data-lang="typescript"><i class="fab fa-js"></i> TypeScript</button>
      <button class="lang-btn" data-lang="swift"><i class="fab fa-swift"></i> Swift</button>
      <button class="lang-btn" data-lang="kotlin"><i class="fas fa-mobile-alt"></i> Kotlin</button>
      <button class="lang-btn" data-lang="dart"><i class="fas fa-mobile-alt"></i> Dart</button>
    </div>
    <pre id="editor" contenteditable="true"></pre>
    <iframe id="preview"></iframe>
  </div>

  <ul class="sources-list" id="sources-list"></ul>
</div>

<script>
let selectedMode='standard';
let activeLang='html';
let canvaFiles={html:'',css:'',js:'',python:'',java:'',typescript:'',swift:'',kotlin:'',dart:''};

const editor=document.getElementById('editor');
const preview=document.getElementById('preview');
const canvaContainer=document.getElementById('canva-container');
const sourcesList=document.getElementById('sources-list');
const generateButton=document.getElementById('generateButton');
const apiKeyInput=document.getElementById('apiKey');

document.querySelectorAll('.mode-tab').forEach(tab=>{
  tab.addEventListener('click',()=>{
    document.querySelectorAll('.mode-tab').forEach(t=>t.classList.remove('active','standard','canva','deepthink','deepresearch'));
    tab.classList.add('active',tab.dataset.mode);
    selectedMode=tab.dataset.mode;
    canvaContainer.style.display=(selectedMode==='canva')?'block':'none';
    sourcesList.innerHTML='';
    document.getElementById('response').textContent='Your output will appear here.';
  });
});

document.querySelectorAll('.lang-btn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active-lang'));
    btn.classList.add('active-lang');
    canvaFiles[activeLang]=editor.textContent;
    activeLang=btn.dataset.lang;
    editor.textContent=canvaFiles[activeLang]||'';
    if(['html','css','js'].includes(activeLang)) updatePreview();
  });
});

editor.addEventListener('input',()=>{
  canvaFiles[activeLang]=editor.textContent;
  if(['html','css','js'].includes(activeLang)) updatePreview();
});

function updatePreview(){
  preview.srcdoc=`<html><head><style>${canvaFiles.css}</style></head><body>${canvaFiles.html}<script>${canvaFiles.js}<\/script></body></html>`;
}

async function generate(){
  const apiKey=apiKeyInput.value.trim();
  const model=document.getElementById('geminiVersion').value;
  const prompt=document.getElementById('userPrompt').value.trim();
  const responseDiv=document.getElementById('response');
  responseDiv.textContent='';
  sourcesList.innerHTML='';

  if(!apiKey || !prompt){responseDiv.textContent='API Key and Prompt required.'; return;}

  generateButton.disabled=true;
  responseDiv.innerHTML='<div class="loader"></div> Awaiting response...';

  const apiUrl=`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;
  let systemPrompt='';
  let tools=[];

  if(selectedMode==='deepthink'){
    systemPrompt="You are a master analytical thinker. Provide a structured, multi-perspective analysis.";
  } else if(selectedMode==='deepresearch'){
    systemPrompt="You are a live researcher. Use verified online info and cite sources.";
    tools=[{google_search:{}}];
  } else if(selectedMode==='canva'){
    systemPrompt=`You are a coding assistant. Generate a complete ${activeLang.toUpperCase()} program only â€” no explanations.`;
  }

  const payload={
    contents:[{parts:[{text:prompt}]}],
    ...(systemPrompt && {systemInstruction:{parts:[{text:systemPrompt}]}}),
    ...(tools.length>0 && {tools:tools})
  };

  try{
    let data;
    for(let attempt=0;attempt<3;attempt++){
      try{
        const res=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
        if(res.status===429&&attempt<2){await new Promise(r=>setTimeout(r,Math.pow(2,attempt)*1500));continue;}
        if(!res.ok)throw new Error(`HTTP ${res.status}`);
        data=await res.json();
        break;
      }catch(e){if(attempt===2)throw e;}
    }

    const candidate=data?.candidates?.[0];
    const text=candidate?.content?.parts?.[0]?.text||'No response.';
    responseDiv.textContent=text;

    if(selectedMode==='canva'){
      canvaFiles[activeLang]=text;
      editor.textContent=text;
      if(activeLang==='html')updatePreview();
    }

    if(selectedMode==='deepresearch'){
      const grounding=candidate?.groundingMetadata?.groundingAttributions||[];
      if(grounding.length>0){
        sourcesList.innerHTML='<li><strong>Sources:</strong></li>';
        grounding.forEach((src,i)=>{
          if(src.web?.uri&&src.web?.title){
            const li=document.createElement('li');
            li.innerHTML=`(${i+1}) <a href="${src.web.uri}" target="_blank">${src.web.title}</a>`;
            sourcesList.appendChild(li);
          }
        });
      }
    }

  }catch(err){
    responseDiv.textContent='Error: '+err.message;
  }finally{
    generateButton.disabled=false;
  }
}
</script>
</body>
</html>
